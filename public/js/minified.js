$(document).ready(function(){$("[data-toggle=offcanvas]").click(function(){$(this).toggleClass("visible-xs text-center");$(this).find("i").toggleClass("glyphicon-chevron-right glyphicon-chevron-left");$(".row-offcanvas").toggleClass("active");$("#lg-menu").toggleClass("hidden-xs").toggleClass("visible-xs");$("#xs-menu").toggleClass("visible-xs").toggleClass("hidden-xs");$("#btnShow").toggle()});$(".global-window").animate({scrollTop:$(".global-window")[0].scrollHeight},1e3);$("html, body").animate({scrollTop:$(document).height()-50},"slow");$("ul.pagination:visible").hide();$(".news-items-sidebar").jscroll({debug:true,autoTrigger:true,nextSelector:".pagination li.active + li a",contentSelector:".sidebar-news-update",callback:function(){$("ul.pagination:visible").hide()}})});$(".profile-pic-sidebar").hover(function(){$(".change_dp_sidebar").fadeIn()},function(){$(".change_dp_sidebar").fadeOut()});$(".modal").on("shown.bs.modal",function(){$(".modal input").focus();$(this).find("[autofocus]").focus()});$("#look-up").selectize({openOnFocus:false,closeAfterSelect:true,maxItems:6,valueField:["username"],labelField:["firstname"],searchField:["firstname","lastname","username"],maxOptions:10,options:[],create:false,render:{option:function(e,t){return'<div class="col-md-12" style="border-bottom: 1.0pt solid #CCC;height:66px;" >'+' <div class="col-md-2 pull-left"> '+' <img src="'+e.image_url+'" class="avatar_filter_black avatar_search_box"/>'+" </div> "+' <div class="col-md-10"> '+"<h5>"+t(e.firstname)+" "+t(e.lastname)+"</h5>"+"<h6>@"+t(e.user.username)+"</h6>"+"</div>"+"</div>"}},load:function(e,t){if(!e.length)return t();var n="All";if($("#look-up").hasClass("Friends"))n="Friends";$.ajax({url:root+"/api/lookUp/"+n,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:{q:e},beforeSend:function(e){return e.setRequestHeader("X-CSRF-Token",$("meta[name='_token']").attr("content"))},error:function(e){t()},success:function(e){t(e.data)}})},onChange:function(){window.location=this.items[0]}});$("#favourite-friend").selectize({selectOnTab:true,openOnFocus:false,closeAfterSelect:true,maxItems:6,valueField:["user_id"],labelField:["firstname"],searchField:["firstname","lastname"],maxOptions:10,options:[],create:false,render:{option:function(e,t){return'<div class="col-sm-6 col-md-4" style="height:190px;" >'+'<a href="#" class="asdf">'+'<div class="thumbnail"> <img src="'+e.image_url+'" alt="image"  class="avatar_filter_black avatar_med"> '+'<div class="caption" style="text-align:center;">'+"<h5> "+t(e.firstname)+" "+t(e.lastname)+" </h5>"+"<h6>@"+t(e.user.username)+"</h6>"+"</div>"+"</div></a>"+"</div>"}},load:function(e,t){if(!e.length)return t();$.ajax({url:root+"/api/lookUp/Favourites",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",data:{q:e},beforeSend:function(e){return e.setRequestHeader("X-CSRF-Token",$("meta[name='_token']").attr("content"))},error:function(){t()},success:function(e){t(e.data)}})},onChange:function(){var e=root+"/api/addFavourite";var t="id="+this.items[0];$.ajax({type:"POST",url:e,data:t,beforeSend:function(e){$("#favourite-friend").attr("disabled",true);return e.setRequestHeader("X-CSRF-Token",$("meta[name='_token']").attr("content"))},success:function(e){alert(e);$(".fav-modal").modal("hide");$("#myFavFriends").load(location.href+" #myFavFriends")},error:function(){}});console.log(this.items[0])}});$("#left-sidebar-notify").click(function(e){$(".icon-bar-notify").addClass("icon-bar-notify-white")});$(document).on("click",".click-me",function(e){alert("ok");$("#newMap").append(' <button type="submit" class="click-me"/> ')});$("#postStatus").submit(function(e){e.preventDefault();var t=$(this).attr("action");var n="body="+$(".status-body").val();if($(".status-body").val()!=""){$.ajax({type:"POST",url:t,data:n,beforeSend:function(e){$("#postStatusBtn").attr("disabled",true);return e.setRequestHeader("X-CSRF-Token",$("meta[name='_token']").attr("content"))},success:function(e){$(".user_nav_status").text(e);$("#postStatusBtn").attr("disabled",false);$(".status-body").val("")},error:function(){}})}});$("#sendGlobal").submit(function(e){e.preventDefault();var t=$(this).attr("action");var n="message="+$(".global_message_body").val();if($(".global_message_body").val()!=""){$.ajax({type:"POST",url:t,data:n,beforeSend:function(e){$(".global_send_button").attr("disabled",true);return e.setRequestHeader("X-CSRF-Token",$("meta[name='_token']").attr("content"))},success:function(e){$(".global_send_button").attr("disabled",false);$(".global_message_body").val("")},error:function(){}})}});$("#search_friend").submit(function(e){e.preventDefault();var t=$(this).attr("action");var n="name="+$(".fav1").val();if($(".fav1").val()!=""){$.ajax({type:"POST",url:t,data:n,beforeSend:function(e){$(".search-friend-btn").attr("disabled",true);return e.setRequestHeader("X-CSRF-Token",$("meta[name='_token']").attr("content"))},success:function(e){alert(e);$(".search-friend-btn").attr("disabled",false);$(".search-friend-btn").val("")},error:function(){}})}});$("#uploadAvatar").submit(function(e){e.preventDefault();var t=$("#choose-avatar").prop("files")[0];var n=$(this).attr("action");if(t==null){swal("Oops...","Please select a file...","error");return false}else{$.ajax({type:"POST",url:n,data:new FormData(this),contentType:false,cache:false,processData:false,beforeSend:function(e){$("#uploadAvatar-btn").attr("disabled",true);$(".uploadAvatar-btn-text").text("Please wait...");return e.setRequestHeader("X-CSRF-Token",$("meta[name='_token']").attr("content"))},success:function(e){$("#uploadAvatar-btn").attr("disabled",false);$(".uploadAvatar-btn-text").text("Upload");$(".change-dp-modal").modal("hide");d=new Date;$(".avatar_sidebar").attr("src",e+d.getTime())},error:function(){}});return true}});$("#sendFriendRequest").click(function(e){var t="email="+$("#userEmail").val();$.ajax({type:"POST",url:root+"/sendFriendRequest",data:t,beforeSend:function(e){$("#sendFriendRequest").attr("disabled",true);return e.setRequestHeader("X-CSRF-Token",$("meta[name='_token']").attr("content"))},success:function(e){if(e==1){$("#AddFriendSpanButton").text("Friend Request Sent");swal({title:"Done!",text:"Friend Request Sent",timer:1e3})}else{$("#sendFriendRequest").attr("disabled",false);swal("Error!",e,"error")}},error:function(){}})});$("#sendFriendEmailRequest").submit(function(e){e.preventDefault();var t=$(this).attr("action");var n=$("#userEmail").val();if($(".add-friend-email").val()!=""&&$(".add-friend-email").val()!=n){$.ajax({type:"POST",url:t,data:new FormData(this),contentType:false,cache:false,processData:false,beforeSend:function(e){$("#addFriendsEmail").attr("disabled",true);return e.setRequestHeader("X-CSRF-Token",$("meta[name='_token']").attr("content"))},success:function(e){if(e==1){$("#addFriendsEmail").attr("disabled",false);$(".add-friend-email").val("");swal({title:"Done!",text:"Friend Request Sent",timer:1e3})}else{$("#addFriendsEmail").attr("disabled",false);$(".add-friend-email").val("");swal("Error!",e,"error")}},error:function(){}})}});$(document).on("click",".asdf",function(e){e.preventDefault();e.stopPropagation();alert("ok")});$(document).on("click",".respond-friend-request",function(e){e.preventDefault();e.stopPropagation();var t=$("#respondToFriendRequest").attr("action");var n=$(this).attr("id");var r=n.split("-");n=r[1];var i=r[2];var s=r[0];var o="id="+i+"&response="+s;var u=$(".new_friend_avatar_id-"+n).attr("src");var a=$(".sender_name-"+n).val();var f=$(".sender_link-"+n).val();$.ajax({type:"POST",url:t,data:o,beforeSend:function(e){$(".accept-friend-request").attr("disabled",true);return e.setRequestHeader("X-CSRF-Token",$("meta[name='_token']").attr("content"))},success:function(e){if(e==0){$(".badge-freq").fadeOut();$(".fa-users-freq").css("color","#efefef");$(".total-friend-requests").prepend('<div class="friend-requests-append">'+'<li style="padding:5px;">No new requests</li>'+'<li class="divider"> </li>'+" </div> ")}$(".freq").text(e);if(s==0){$("#1-"+n+"-"+i).fadeOut(200);$("#0-"+n+"-"+i).attr("disabled",true);$(".friend-request-"+n).fadeOut()}else{$("#0-"+n+"-"+i).fadeOut(200);$("#1-"+n+"-"+i).attr("disabled",true)}},error:function(){}})});$(function(){function t(e){$("#v-nav ul li[tab*="+e+"]").click()}var e=$("#v-nav>ul>li").each(function(){$("#v-nav>div.tab-content").first().show();$(this).click(function(){$("#v-nav>div.tab-content").hide().eq(e.index($(this))).show()})});if(location.hash){t(location.hash)}else{t("tab1")}});(function(){var e=new Pusher("c01e574cb9520fc388bc");var t=e.subscribe("FriendRequestChannel");t.bind("userSentRequest",function(e){if(auth_user==e.receiver_email){$(".fa-users").css("color","#FF6666");$(".icon-bar").removeClass("icon-bar-notify-white");$(".icon-bar").addClass("icon-bar-notify");$(".freq").fadeIn();$(".no-new-req").fadeOut();$(".freq").text(e.total_req);console.log(e.request_id);$(".friend-requests-append").prepend('<div class="friend-request-'+e.request_id+'" id="friend-req-id" >'+'  <li>   <div class="freq-panel"> <input type="text" style="display:none;" class="sender_name-'+e.request_id+'" value="'+e.sender_name+'"/> <input type="text" style="display:none;" class="sender_link-'+e.request_id+'" value="'+e.sender_link+'"/> '+'  <img src="'+e.img+'" class="avatar_tiny new_friend_avatar_id-'+e.request_id+'" alt="avatar"/> '+"    "+e.sender_name+' <div class="new-friend-request-info"> '+e.gender+' <div class="accept-reject-friend-button "> '+'   <div class="replace-friends-button-'+e.request_id+'"> <form method="POST" action="'+e.url+'" accept-charset="UTF-8" id="respondToFriendRequest" class="ng-pristine ng-valid">'+'   <button type="submit" class="btn btn-success btn-xs respond-friend-request" id="1-'+e.request_id+"-"+e.sender_id+'"> <span class="glyphicon glyphicon-ok-sign" aria-hidden="true"></span></button>'+'   <button type="submit" class="btn btn-danger btn-xs respond-friend-request" id="0-'+e.request_id+"-"+e.sender_id+'"> <span class="glyphicon glyphicon-remove-sign" aria-hidden="true"></span> </button> '+' </form></div></div></div></div> </li> <li class="divider"></li>'+" </div>")}});var n=e.subscribe("RecentUpdateChannel");n.bind("userDidRecent",function(e){var t=e.url;var n="";var r="user="+e.user_id+"&type="+e.type+"&postId="+e.post_id;$.ajax({type:"POST",url:t,data:r,beforeSend:function(e){return e.setRequestHeader("X-CSRF-Token",$("meta[name='_token']").attr("content"))},success:function(t){if(t!=0){if(t.status_body.length>90){n="Click to se more..."}$(".sidebar-no-updates").fadeOut();$(".news-items-sidebar").prepend('<div class="sidebar-news-update new-update-background sidebar-news-update-'+e.root_id+' ">'+'<img src="'+t.avatar+'" class="avatar_tiny img-circle" alt="avatar">'+'<a href="'+t.url+'"> '+t.info.firstname+"  "+t.info.lastname+" </a>"+'<small style="float:right;"> '+t.status_time+" </small>"+'<div class=" col-md-offset-2 recent-updates-body-sidebar">  '+t.status_body+" <small>"+n+"</small> </div>"+'<hr style="height:1px;"> '+" </div>");setTimeout(function(){$(".sidebar-news-update-"+e.root_id).removeClass("new-update-background")},7e3)}},error:function(){}})});var r=e.subscribe("GlobalMessageChannel");r.bind("newGlobalMessage",function(e){var t=$("#userEmail").val();var n="msg="+e.message;var r=$("#decrypt-message").val();$.ajax({type:"POST",url:r,data:n,beforeSend:function(e){return e.setRequestHeader("X-CSRF-Token",$("meta[name='_token']").attr("content"))},success:function(n){$(".global-window").animate({scrollTop:$(".global-window")[0].scrollHeight},1e3);if(t!=e.email){$(".global-window").append('<div class="row">'+' <div class="col-md-1 pull-left chat_img_pos_left" style="padding:0px;">'+'  <a href="'+e.user_link+'"> <img src="'+e.img+'" class="chat_img img-responsive"/>'+'  <div class="tooltip"> </div> </a> </div>'+'  <div class="col-md-5 pull-left Area-left">'+' <div class="col-md-12" style="padding:0px;">'+' <div class="col-md-10 col-md-offset-2 pull-left text-left chat_username"> Me  </div>'+' <div class="col-md-8 col-md-offset-4 pull-left text-left chat_time"> Just now... </div>'+' <div class="col-md-12 pull-right text-center chat_text_left"> '+n+" </div>"+"</div> </div>")}else{$(".global-window").append('<div class="row">'+'  <div class="col-md-1 pull-right chat_img_pos" style="padding:0px;"> '+'  <a href="'+e.user_link+'"> <img src="'+e.img+'" class="chat_img img-responsive"/>'+'  <div class="tooltip"> </div> </a> </div>'+'  <div class="col-md-5 pull-right Area">'+' <div class="col-md-12" style="padding:0px;">'+' <div class="col-md-10 col-md-offset-2 pull-right text-left chat_username"> '+e.username+"  </div>"+'  <div class="col-md-8 col-md-offset-4 pull-right text-right chat_time">  Just now... </div>'+' <div class="col-md-12 pull-left text-center chat_text"> '+n+" </div>"+"</div> </div>")}},error:function(){}})})})()